# [C/C++程序编译过程](https://www.cnblogs.com/mickole/articles/3659112.html)

C语言的编译链接过程要把我们编写的一个c程序（源代码）转换成可以**在硬件上运**行的程序（可执行代码），需要进行编译和链接。**编译**就是把**文本形式源代码**翻译为机器语言形式的**目标文件**的过程。**链接**是把**目标文件**、**操作系统的启动代码**和**用到的库文件**进行组织，形成最终**生成可执行代码**的过程。过程图解如下：<img src="https://images0.cnblogs.com/blog/529981/201404/111709143728318.jpg" alt="clip_image002" style="zoom:67%;" />编译是读取源程序（字符流），对之进行词法和语法的分析，将高级语言指令转换为功能等效的汇编代码，源文件的编译过程包含两个主要阶段：

##### 编译预处理

读取c源程序，对其中的伪指令（以# 开头的指令）和特殊符号进行处理。

##### 编译、优化阶段

优化处理是编译系统中一项比较艰深的技术。

经过优化得到的汇编代码必须经过汇编程序的汇编转换成相应的机器指令，方可能被机器执行。

[编译过程又可以分成两个阶段：编译和汇编。](https://www.cnblogs.com/mickole/articles/3659112.html)

#### 汇编

汇编过程实际上指把汇编语言代码翻译成目标机器指令的过程。

目标文件由段组成。通常一个目标文件中至少有两个段：

\1) 代码段：可读和可执行的，但一般却不可写。

\2) 数据段：可读，可写，可执行

### 2. 链接过程

例如，某个源文件中的函数可能**引用了另**一个源文件中定义的**某个符号**（如变量或者函数调用等）；在程序中可能调用了某个库文件中的函数，等等。所有的这些问题，都需要经链接程序的处理方能得以解决。

由汇编程序生成的目标文件并不能立即就被执行，其中可能还有许多没有解决的问题。

链接处理可分为两种：

\1) 静态链接

函数的代码将从其所在的静态链接库中被**拷贝**到最终的可执行程序中。

动态链接能够使最终的可执行文件比**较短小**，并且当共享对象被多个进程使用时能**节约一些内存**，因为在内存中只需要保存一份此共享对象的代码。

总结起来编译过程就上面的四个过程：预编译处理(.c) －－> 编译、优化程序（.s、.asm）－－> 汇编程序(.obj、.o、.a、.ko) －－> 链接程序（.exe、.elf、.axf等）。

##### １、静态链接库

方便程序移植，因为可执行程序与库函数再无关系，放在如何环境当中都可以执行。

缺点是：文件太大，一个全静态方式生成的简单print文件都有857K。而动态链接生成的一样的可执行文件却只要8.４Ｋ。

> 在linux中，静态库为lib*.a，动态库为lib*.so。