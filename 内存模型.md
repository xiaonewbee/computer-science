## 1.1 内存模型

### 1.1.0 内存四区

意义在于：赋予其不同的生命周期，给编程带来更大的灵活性

- 运行前

  - 代码区

    ：存放函数体的

    二进制代码

    ，由操作系统管理

    - 共享的
    - 只读的：防止程序意外修改其指令

  - 全局区

    ：存放

    全局变量和静态变量以及常量

    ，结束后由系统释放

    - 全局区还包括常量区（字符串常量，const修饰的全局常量）

- 运行后

  - 栈区

    ：由

    编译器自动分配和释放

    ，存放

    函数体的参数值、局部变量

    等

    - 不能返回局部变量的地址，当离开作用域后，开辟在栈区的局部变量会被编译器自动回收

  - 堆区

    ：由

    程序员分配和释放

    ，若不释放，程序结束后由操作系统释放

    - 分全局堆和局部堆
    - 全局堆就是所有没有分配的空间，局部堆就是用户分配的空间
    - 堆在操作系统对进程 初始化的时候分配，运行过程中也可以向系统要额外的堆

### 1.1.1 简述C、C++程序编译的内存分配情况

- **从静态存储区域分配**：
  内存在程序 编译 时 就已 经 分配 好，这块内 存在 程序 的整 个运行 期间 都存在 。速 度快、不容易出错 ， 因 为 有系 统 会善 后。例 如全 局变 量， sta tic 变量， 常量 字符 串等。
- **在栈上分配**：
  在执行函数时， 函数内局部变量的存储单元都在栈上创建，函数执行结束时这些存储单元自动被释放。 栈内存分配运算内置于处理器的指令集中， 效率很高， 但是 分配的内存容量有限 。大小为2M。
- **从堆上分配**：
  即动态内存分配。程序在运行的时候用 malloc 或 new 申请任意大小的内存，程序员自己负责在何时用 free 或delete 释放内存。动态内存的生存期由程序员决定，使用非常灵活。如果在堆上分配了空间，就有责任回收它，否则运行的程序会出现内存泄漏 ，另外频繁地分配和释放不同大小的堆空间将会产生堆内碎块 。